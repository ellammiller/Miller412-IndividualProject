;jQuery(document).ready(function(){var e=jQuery("div.form-actions button.bf-submit[type=submit], div.form-actions button.bf-draft[type=button]"),i;if(e.length>0){i=jQuery.map(e,function(e){return(jQuery(e).attr("type")==="submit"&&jQuery(e).hasClass("bf-submit"))?jQuery(e):null})[0];var l=i.html()};jQuery(".featured-image-uploader").each(function(o,s){var a=jQuery(this),r=a.attr("id"),u=a.attr("max_file_size"),m=a.attr("action"),c=a.attr("page"),t=a.data("entry"),b=a.find("input:text");Dropzone.autoDiscover=!1;var n=c!=="buddyforms_submissions",d=jQuery("#field_"+r);if(buddyformsGlobal){var f=new Dropzone("div#"+r,{url:buddyformsGlobal.admin_url,maxFilesize:u,acceptedFiles:"image/*",maxFiles:1,clickable:n,addRemoveLinks:n,init:function(){this.on("complete",function(){if(e.length>0){e.removeAttr("disabled");i.html(l)}});this.on("addedfile",function(){jQuery("#field_"+r+"-error").text("");if(this.files.length>1){this.removeFile(this.files[0])};if(e.length>0){e.attr("disabled","disabled");i.html(buddyformsGlobal.localize.upload.submitButton||"Upload in progress")}});this.on("sending",function(e,i,l){l.append("action","handle_dropped_media");l.append("nonce",buddyformsGlobal.ajaxnonce)});this.on("success",function(e,i){a.removeClass("error");e.previewElement.classList.add("dz-success");e["attachment_id"]=i;var l=d.val()+","+i,o="";if(l[0]===","){o=l.substring(1,l.length)}
else{o=l};d.val(o)});this.on("error",function(a,o){a.previewElement.classList.add("dz-error");jQuery(a.previewElement).find("div.dz-error-message>span").text(o);if(e.length>0){e.removeAttr("disabled");i.html(l)}});this.on("removedfile",function(o){var t=o.attachment_id,s=d.val(),a=s.replace(t,"");if(a[0]===","){a=a.substring(1,s.length)};var r=a[a.length-1];if(r===","){a=a.slice(0,-1)};d.val(a);e.attr("disabled","disabled");jQuery.post(buddyformsGlobal.admin_url,{action:"handle_deleted_media",media_id:t,nonce:buddyformsGlobal.ajaxnonce},function(e){console.log(e)}).always(function(){if(e.length>0){e.removeAttr("disabled");i.html(l)}})});if(t){for(var s in t){if(s){var o={name:t[s]["name"],size:t[s]["size"],url:t[s]["url"],attachment_id:t[s]["attachment_id"]};this.emit("addedfile",o);this.emit("thumbnail",o,o.url);this.emit("complete",o);this.files.push(o)}}}},dictMaxFilesExceeded:buddyformsGlobal.localize.upload.dictMaxFilesExceeded||"You can not upload any more files.",dictRemoveFile:buddyformsGlobal.localize.upload.dictRemoveFile||"Remove file",dictCancelUploadConfirmation:buddyformsGlobal.localize.upload.dictCancelUploadConfirmation||"Are you sure you want to cancel this upload?",dictCancelUpload:buddyformsGlobal.localize.upload.dictCancelUpload||"Cancel upload",dictResponseError:buddyformsGlobal.localize.upload.dictResponseError||"Server responded with {{statusCode}} code.",dictInvalidFileType:buddyformsGlobal.localize.upload.dictInvalidFileType||"You can't upload files of this type.",dictFileTooBig:buddyformsGlobal.localize.upload.dictFileTooBig||"File is too big ({{filesize}}MiB). Max filesize: {{maxFilesize}}MiB.",dictFallbackMessage:buddyformsGlobal.localize.upload.dictFallbackMessage||"Your browser does not support drag'n'drop file uploads.",dictDefaultMessage:buddyformsGlobal.localize.upload.dictDefaultMessage||"Drop files here to upload",})}})});